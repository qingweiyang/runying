
<!-- 主页面 -->

<div id="process-main">
  <!-- 面包屑导航 -->
  <ul class="breadcrumb">
    <li>
     <a href="#">产品管理</a>
    </li>
    <li class="active">
       产品列表
    </li>
  </ul>

  <div class="panel panel-info table-panel">
      <!-- Default panel contents -->
      <div class="panel-heading">
        <!-- 表格的筛选操作 -->
        <div class="row clearfix">

          <!-- 表格select筛选 -->
          <div>
            <div class="col-md-1 column form-pre-des">
              名称
            </div>
            <div class="col-md-2 column">
              <select class="form-control">
                <option>Enter</option>
                <option>Your</option>
                <option>Options</option>
                <option>Here!</option>
              </select>
            </div>
          </div>
          <!-- 表格搜索 -->
          <div class="col-md-3 col-md-offset-5">
            <div class="input-group">
              <input type="text" class="form-control" placeholder="输入关键字进行搜索...">
              <span class="input-group-btn">
                <button class="btn btn-default" type="button">搜索</button>
              </span>
            </div><!-- /input-group -->
          </div><!-- /.col-lg-6 -->
        </div>
      </div>

      <table id="current-table" class="table table-hover">
        <thead>
          <tr class="active">
            <th>#</th>
            <th>产品名</th>
            <th>规格型号1</th>
            <th>规格型号2</th>
            <th>物料长代码</th>
            <th>材质</th>
            <th>操作</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
  </div>

  <!-- 分页 -->
  <nav>
    <ul class="pagination">
    </ul>
  </nav>
</div>

<script src="js/page_division.js"></script>  
<script type="text/javascript">

  $(document).ready(function() {
	  show(1, countPerPage);
  });

  // 权限编辑
  function productEdit(item) {
    $("#process-main").empty();
    $("#process-main").load("productEdit.html", function() {
        $("#id").text(item.id);
        $("#name").val(item.materialName);
        $("#size1").val(item.size1);
        $("#size2").val(item.size2);
        $("#materialCode").val(item.materialCode);
        $("#material").val(item.material);
    }); 
  }

  function deleteProduct(product) {
    $.ajax({
      type : "POST",
      contentType : 'application/json', 
      url : "deleteProduct.do",
      data : JSON.stringify(product), 
      dataType: "json",
      success : function(data) {
  
          if(data.status == 1) {
        	//刷新
          	setTimeout('loadProductList();', 500);
            
          } else {
            alert(data.description);
          }
      },
      error : function(){
          alert("error");
      }
    });
  }
    
  function show(currentPage, countPerPage) {
    var param = {};
    param.currentPage = currentPage;
    param.countPerPage = countPerPage;
    loading();
    $.get(
      "getUndeletedProduct.do",
      param,
      function(data) {
        var text = "";
        var option = "";
        $.each(data.rows, function(i, item) {
        	option = "<a href='javascript:void(0);' onclick='productEdit("+JSON.stringify(item)+");'><i class='fa fa-pencil-square-o fa-lg'> </i></a>  ";
          option += "<a href='javascript:void(0);' onclick='deleteProduct("+JSON.stringify(item)+");'><i class='fa fa-trash fa-lg'> </i></a>";

          text += "<tr><td>"+(i+1)+"</td>"+
                      "<td>"+item.materialName+"</td>"+
                      "<td>"+item.size1+"</td>"+
                      "<td>"+item.size2+"</td>"+
                      "<td>"+item.materialCode+"</td>"+
                      "<td>"+item.material+"</td>"+
                      "<td>"+option+"</td>"+
                      "</tr>";
        });
        $("#current-table tbody").html(text);
        pageDivision(data.pages, currentPage);
        loadingEnd();
      });
  }
</script>